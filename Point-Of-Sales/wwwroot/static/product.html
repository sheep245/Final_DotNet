<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin's product page</title>
    <link rel="icon" type="image/x-icon" href="../public/images/favicon.png">
    <link href="../public/stylesheets/product.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</head>

<body>
    <div id="nav"></div>
    <!-- Search bar -->
    <div id="search-bar">
        <input type="text" placeholder="Search...">
        <button type="submit"><i class="fas fa-search"></i></button>
    </div>
    <div id="Addbtn">
        <!-- Add product button -->
        <button id="add-product" onclick="openPopup()">Add product</button>
    </div>

    <section>
        <!-- Product grid -->
        <div id="product-grid">
            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>

            <div class="product">
                <img src="../public/images/iphone.png" alt="Product image">
                <p class="item">
                    Iphone
                </p>
                <p class="price">
                    5000 $
                </p>
                <div class="icon-container">
                    <button class="update-product"><i class="fas fa-edit"></i></button>
                    <button class="delete-product"><i class="fas fa-trash"></i></button>
                </div>
            </div>


        </div>
    </section>

    <!-- The popup form - Add product -->
    <form id="popupForm" style=" display:none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);"
        onsubmit="submitForm(event)">
        <span id="closeButton" onclick="closePopup()" style="float:right; cursor:pointer;">x</span>
        <h2>Add new product</h2>
        <label for="barcode">Barcode:</label><br>
        <input type="text" id="barcode" name="barcode" required><br>
        <label for="productName">Product Name:</label><br>
        <input type="text" id="productName" name="productName" required><br>
        <label for="importPrice">Import Price:</label><br>
        <input type="text" id="importPrice" name="importPrice" required><br>
        <label for="retailPrice">Retail Price:</label><br>
        <input type="text" id="retailPrice" name="retailPrice" required><br>
        <label for="category">Category:</label><br>
        <input type="text" id="category" name="category" required><br>
        <label for="creationDate">Creation Date:</label><br>
        <input type="date" id="creationDate" name="creationDate"><br>
        <label for="productImage">Product Image:</label><br>
        <input type="file" id="productImage" name="productImage" onchange="previewImage(event)" required><br>
        <img id="imagePreview" src="" style="display:none; width:100px; height:100px;"><br>
        <button>Create</button>
    </form>

    <!-- The edit product popup form -->
    <form id="editProductForm"
        style="display:none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <span id="closeEditButton" style="float:right; cursor:pointer;">x</span>
        <h2>Product details</h2>
        <!-- Add your product fields here -->
        <label for="barcode">Barcode:</label><br>
        <input type="text" id="barcode" name="barcode" required><br>
        <label for="productName">Product Name:</label><br>
        <input type="text" id="productName" name="productName" required><br>
        <label for="importPrice">Import Price:</label><br>
        <input type="text" id="importPrice" name="importPrice" required><br>
        <label for="retailPrice">Retail Price:</label><br>
        <input type="text" id="retailPrice" name="retailPrice" required><br>
        <label for="category">Category:</label><br>
        <input type="text" id="category" name="category"><br>
        <label for="creationDate">Creation Date:</label><br>
        <input type="date" id="creationDate" name="creationDate"><br>
        <label for="productImage">Product Image:</label><br>
        <input type="file" id="productImage" name="productImage" required><br>
        <button>Confirm</button>
    </form>
    <div id="footer"></div>

    <script>
        $(function () {
            //import navbar and footer
            $("#nav").load("./nav.html");
            $("#footer").load("./footer.html");
        });
        function previewImage(event) {
            const reader = new FileReader()
            reader.onload = function () {
                const output = document.getElementById('imagePreview')
                output.src = reader.result
                output.style.display = 'block'
            }
            reader.readAsDataURL(event.target.files[0])
        }

        function openPopup() {
            const popupForm = document.getElementById('popupForm')
            popupForm.style.display = 'block'
        }

        function closePopup() {
            const popupForm = document.getElementById('popupForm')
            popupForm.style.display = 'none'
        }


        // ***** DELETE PRODUCT *****
        // Get all delete buttons
        var deleteButtons = document.getElementsByClassName("delete-product");

        // Add a click event listener to each delete button
        for (var i = 0; i < deleteButtons.length; i++) {
            deleteButtons[i].addEventListener("click", function () {
                // Confirm deletion
                if (confirm("Are you sure you want to delete this product?")) {
                    // If the user clicked "OK", delete the product
                    var product = this.parentElement.parentElement;
                    product.parentElement.removeChild(product);
                }
            });
        }

        // ***** UPDATE PRODUCT *****
        // Get all edit buttons
        var editButtons = document.getElementsByClassName("update-product");

        // Get the edit product form
        var editForm = document.getElementById("editProductForm");

        // Get the close edit button
        var closeEdit = document.getElementById("closeEditButton");

        // Add a click event listener to each edit button
        for (var i = 0; i < editButtons.length; i++) {
            editButtons[i].addEventListener("click", function () {
                // Show the edit product form
                editForm.style.display = "block";
            });
        }

        // When the user clicks on the close edit button, close the edit product form
        closeEdit.onclick = function () {
            editForm.style.display = "none";
        }
    </script>
</body>

</html>